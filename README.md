# Spring 핵심 원리 - 고급편

## Thread Local

싱글톤 클래스에 필드를 선언해서 사용하면, 동시성 문제가 반드시 발생하는데, 필드를 읽는 경우에는 동시성 문제가 발생하지 않지만, 필드를 `동시에 수정하는 경우` 에 동시성 문제가 발생한다.

이 때, `ThreadLocal` 객체를 사용하면, 동시성 문제를 해결할 수 있다. ThreadLocal 특징을 다음과 같이 요약할 수 있다.

- 해당 스레드만 접근할 수 있는 특별한 저장소이다.
- 각 스레드의 별도 내부 저장소이다.
- 같은 인스턴스의 스레드 로컬 필드에 접근해도 문제가 없다.

### 주의할 점

ThreadLocal을 사용하고 나면, 반드시 `remove()` 메서드를 통해 저장된 값을 제거해야한다. WAS(Tomcat) 처럼 Thread Pool을 사용하는 경우 심각한 문제가 발생한다.

ex) `remove()` 를 하지 않으면, 이전 사용자의 정보가 남아있는 치명적인 문제가 발생한다.
